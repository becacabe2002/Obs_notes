## 1. Tá»•ng quan
* TÃ i nguyÃªn TT cáº§n 
	* Bá»™ xá»­ lÃ½ (áº£o)[[Chap2.4 - TÃ i nguyÃªn gÄƒng vÃ  Ä‘iá»u Ä‘á»™ tiáº¿n trÃ¬nh]]
	* Bá»™ nhá»› [[Chap3 - Quáº£n lÃ½ bá»™ nhá»›]]
	* Táº­p tÃ i nguyÃªn khÃ¡c

### 1.1 VÃ­ dá»¥
### 1.2 Bá»™ nhá»› vÃ  chÆ°Æ¡ng trÃ¬nh
#### PhÃ¢n cáº¥p bá»™ nhá»›
* Bá»™ nhá»› - tÃ i nguyÃªn quan trá»ng cá»§a há»‡ thá»‘ng
	* ChÆ°Æ¡ng trÃ¬nh pháº£i náº±m trong bá»™ nhá»› Ä‘á»ƒ thá»±c hiá»‡n

* Äáº·c trÆ°ng cá»§a bá»™ nhá»› : **kÃ­ch thÆ°á»›c** vÃ  **tá»‘c Ä‘á»™ truy cáº­p**

> [!note] PhÃ¢n cáº¥p theo tá»‘c Ä‘á»™ truy cáº­p
> ![[Pasted image 20221219233705.png]]

#### Bá»™ nhá»›  chÃ­nh
> [!info] Bá»™ nhá»› chÃ­nh
> LÃ  máº£ng cÃ¡c Ã´ nhá»› kiá»ƒu bytes, words vá»›i má»—i Ã´ nhá»› cÃ³ má»™t Ä‘á»‹a chá»‰ riÃªng (***Äá»‹a chá»‰ váº­t lÃ½*** - Ä‘á»‹a chá»‰ xuáº¥t hiá»‡n á»Ÿ chÃ¢n VXL).
> ÄÆ°á»£c dÃ¹ng lÆ°u trá»¯ dá»¯ liá»‡u vÃ  chÆ°Æ¡ng trÃ¬nh.

![[Pasted image 20221219235512.png]]

![[Pasted image 20221219235521.png]]

#### ChÆ°Æ¡ng trÃ¬nh
> [!info] ChÆ°Æ¡ng trÃ¬nh
> * LÃ  cÃ¡c file nhá»‹ phÃ¢n thá»±c thi Ä‘Æ°á»£c:
> 	* VÃ¹ng tham sá»‘ file
> 	* Lá»‡nh mÃ¡y (MÃ£ nhá»‹ phÃ¢n)
> 	* VÃ¹ng dá»¯ liá»‡u (Biáº¿n toÃ n cá»¥c)
> * Tá»“n táº¡i trÃªn thiáº¿t bá»‹ lÆ°u trá»¯ ngoÃ i

> [!info]  HÃ ng Ä‘á»£i vÃ o (input queue)
> * Táº­p cÃ¡c tiáº¿n trÃ¬nh á»Ÿ bá»™ nhá»› ngoÃ i (thÃ´ng thÆ°á»ng lÃ  disk).
> * Äá»£i Ä‘á»ƒ Ä‘Æ°á»£c Ä‘Æ°a vÃ o bá»™ nhá»› trong vÃ  thá»±c hiá»‡n.

> [!note] CÃC BÆ¯á»šC THá»°C HIá»†N CHÆ¯Æ NG TRÃŒNH
> 1. **Náº¡p chÆ°Æ¡ng trÃ¬nh vÃ o bá»™ nhá»›**
> 	* Äá»c vÃ  dá»‹ch file thá»±c thi (\*.com, \*.exe)
> 	* Xin vÃ¹ng nhá»› Ä‘á»ƒ náº¡p chÆ°Æ¡ng trÃ¬n tá»« file trÃªn Ä‘Ä©a
> 	* Thiáº¿t láº­p cÃ¡c tham sá»‘, cÃ¡c thanh ghi tá»›i giÃ¡ trá»‹ thÃ­ch há»£p
> 2. **Thá»±c thi chÆ°Æ¡ng trÃ¬nh**
> 	* CPU láº¥y cÃ¡c lá»‡nh trong bá»™ nhá»› táº¡i vá»‹ trÃ­ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh (PC)
> 	* CPU giáº£i mÃ£ lá»‡nh (CÃ³ thá»ƒ láº¥y thÃªm toÃ¡n háº¡ng tá»« bá»™ nhá»›)
> 	* Thá»±c hiá»‡n lá»‡nh vá»›i toÃ¡n háº¡ng
> 	* LÆ°u káº¿t quáº£ vÃ o bá»™ nhá»› táº¡i má»™t Ä‘á»‹a chá»‰ xÃ¡c Ä‘á»‹nh (Náº¿u cáº§n)
> 3. **Giáº£i phÃ³ng vÃ¹ng khÃ´ng gian nhá»›** dÃ nh cho chÆ°Æ¡ng trÃ¬nh sau khi thá»±c hiá»‡n xong.

> [!warning] Váº¥n Ä‘á».
> ChÆ°Æ¡ng trÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c náº¡p vÃ o vá»‹ trÃ­ báº¥t ká»³ trong bá»™ nhá»›. Khi thá»±c hiá»‡n, CT sinh ra chuá»—i Ä‘á»‹a chá»‰ bá»™ nhá»›.
> ğŸ‘‰**Truy cáº­p Ä‘á»‹a chá»‰ bá»™ nhá»› nhÆ° tháº¿ nÃ o?**

### 1.3 LiÃªn káº¿t Ä‘á»‹a chá»‰
> [!note] CÃ¡c bÆ°á»›c xá»­ lÃ½ chÆ°Æ¡ng trÃ¬nh á»©ng dá»¥ng
> ![[Pasted image 20221205125234.png]]

#### CÃ¡c kiá»ƒu Ä‘á»‹a chá»‰
> [!info] Äá»‹a chá»‰ biá»ƒu tÆ°á»£ng (symbolic)
> TÃªn cá»§a Ä‘á»‘i tÆ°á»£ng trong chÆ°Æ¡ng trÃ¬nh nguá»“n

> [!info] Äá»‹a chá»‰ tÆ°Æ¡ng Ä‘á»‘i 
> * Sinh ra tá»« Ä‘á»‹a chá»‰ biá»ƒu tÆ°á»£ng trong giai Ä‘oáº¡n dá»‹ch (compiler)
> * LÃ  vá»‹ trÃ­ tÆ°Æ¡ng Ä‘á»‘i cá»§a Ä‘á»‘i tÆ°á»£ng ká»ƒ tá»« Ä‘áº§u modul

> [!info] Äá»‹a chá»‰ tuyá»‡t Ä‘á»‘i
> * Sinh ra tá»« Ä‘á»‹a chá»‰ tÆ°Æ¡ng Ä‘á»‘i trong giai Ä‘oáº¡n náº¡p chÆ°Æ¡ng trÃ¬nh thá»±c thi vÃ o bá»™ nhá»› Ä‘á»ƒ thá»±c hiá»‡n
> > [!example] 
> > Vá»›i PC: Ä‘á»‹a chá»‰ tÆ°Æ¡ng Ä‘á»‘i \<Seg :Ofs\> -> Seg * 16 + Ofs
> 
> * LÃ  Ä‘á»‹a chá»‰ cá»§a Ä‘á»‘i tÆ°á»£ng trong bá»™ nhá»› váº­t lÃ½ (Ä‘á»‹a chá»‰ váº­t lÃ½)

#### XÃ¡c Ä‘á»‹nh Ä‘á»‹a chá»‰
* XÃ¡c Ä‘á»‹nh Ä‘á»‹a chá»‰ cÃ¢u lá»‡nh vÃ  dá»¯ liá»‡u cÃ³ thá»ƒ thá»±c hiá»‡n á»Ÿ cÃ¡c giai Ä‘oáº¡n khÃ¡c nhau khi xá»­ lÃ½ chÆ°Æ¡ng trÃ¬nh á»©ng dá»¥ng
	* **Giai Ä‘oáº¡n dá»‹ch** :
		* Sá»­ dá»¥ng náº¿u biáº¿t chÆ°Æ¡ng trÃ¬nh sáº½ náº±m á»Ÿ Ä‘Ã¢u trong bá»™ nhá»›
		* Khi dá»‹ch sáº½ sinh ra Ä‘á»‹a chá»‰ tuyá»‡t Ä‘á»‘i
		* Pháº£i dá»‹ch láº¡i khi vá»‹ trÃ­ báº¯t Ä‘áº§u thay Ä‘á»•i
	* **Thá»i Ä‘iá»ƒm náº¡p** :
		* Sá»­ dá»¥ng khi khÃ´ng biáº¿t chÆ°Æ¡ng trÃ¬nh sáº½ náº±m á»Ÿ Ä‘Ã¢u trong bá»™ nhá»›
		* CÃ¡c Ä‘á»‘i tÆ°á»£ng sáº½ Ä‘Æ°á»£c dá»‹ch ra sáº½ mang Ä‘á»‹a chá»‰ tÆ°Æ¡ng Ä‘á»‘i
		* XÃ¡c Ä‘á»‹nh Ä‘á»‹a chá»‰ Ä‘Æ°á»£c hoÃ£n láº¡i tá»›i khi náº¡p chÆ°Æ¡ng trÃ¬nh vÃ o bá»™ nhá»›.
	* **Trong khi thá»±c hiá»‡n** : 
		* Sá»­ dá»¥ng khi cÃ¡c tiáº¿n trÃ¬nh cÃ³ thá»ƒ thay Ä‘á»•i vá»‹ trÃ­ trong khi thá»±c hiá»‡n
		* XÃ¡c Ä‘á»‹nh Ä‘á»‹a chá»‰ Ä‘Æ°á»£c hoÃ£n láº¡i tá»›i khi thá»±c thi chÆ°Æ¡ng trÃ¬nh
		* ÄÆ°á»£c sá»­ dá»¥ng trong nhiá»u há»‡ Ä‘iá»u hÃ nh 
![[Pasted image 20221205125753.png]]

> [!info] Äá»‹a chá»‰ logic (Äá»‹a chá»‰ áº£o)
> * ÄÆ°á»£c sinh ra trong tiáº¿n trÃ¬nh (CPU Ä‘Æ°a ra)
> * ÄÆ°á»£c khá»‘i quáº£n lÃ½ bá»™ nhá»› (MMU) chuyá»ƒn sang Ä‘á»‹a chá»‰ váº­t lÃ½ khi truy cáº­p tá»›i Ä‘á»‘i trÆ°á»£ng trong chÆ°Æ¡ng trÃ¬nh.

> [!info] Äá»‹a chá»‰ váº­t lÃ½
> * Äá»‹a chá»‰ cá»§a má»™t pháº§n tá»­ (byte/word) cá»§a bá»™ nhá»›
> * TÆ°Æ¡ng á»©ng vá»›i Ä‘á»‹a chá»‰ logic Ä‘Æ°á»£c CPU Ä‘Æ°a ra

> [!note] ChÆ°Æ¡ng trÃ¬nh lÃ m viá»‡c vá»›i Ä‘á»‹a chá»‰ logic

![[Pasted image 20221220084830.png]]

### 1.4 CÃ¡c cáº¥u trÃºc chÆ°Æ¡ng trÃ¬nh
#### Cáº¥u trÃºc tuyáº¿n tÃ­nh
* Sau khi biÃªn táº­p, cÃ¡c module Ä‘Æ°á»£c táº­p há»£p thÃ nh má»™t chÆ°Æ¡ng trÃ¬nh hoÃ n thiá»‡n
	* Chá»©a Ä‘áº§y Ä‘á»§ cÃ¡c thÃ´ng tin Ä‘á»ƒ cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c
	* CÃ¡c biáº¿n trá» ngoÃ i Ä‘Ã£ thay báº±ng 1 giÃ¡ trá»‹ cá»¥ thá»ƒ
	* Äá»ƒ thá»±c hiá»‡n, chá»‰ cáº§n **Ä‘á»‹nh vá»‹ 1 láº§n trong bá»™ nhá»›**
![[Pasted image 20221220085112.png]]

> [!check] Æ¯u Ä‘iá»ƒm
> * ÄÆ¡n giáº£n, dá»… tá»• chá»©c biÃªn táº­p vÃ  Ä‘á»‹nh vá»‹ chÆ°Æ¡ng trÃ¬nh
> * Thá»i gian thá»±c hiá»‡n nhanh
> * TÃ­nh lÆ°u Ä‘á»™ng cao

> [!failure] NhÆ°á»£c Ä‘iá»ƒm
> * LÃ£ng phÃ­ bá»™ nhá»› (ko pháº£i toÃ n bá»™ chÆ°Æ¡ng trÃ¬nh Ä‘á»u cáº§n thiáº¿t cho thá»±c hiá»‡n chÆ°Æ¡ng trÃ¬nh)
> * KhÃ´ng thá»±c hiá»‡n Ä‘Æ°á»£c chÆ°Æ¡ng trÃ¬nh cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n kÃ­ch thÆ°á»›c bá»™ nhá»› váº­t lÃ½

#### Cáº¥u trÃºc náº¡p Ä‘á»™ng
* Má»—i modul Ä‘Æ°á»£c biÃªn táº­p riÃªng
* Khi thá»±c hiá»‡n, há»‡ thá»‘ng sáº½ Ä‘á»‹nh vá»‹  modul gá»‘c
* Cáº§n tá»›i modul nÃ o sáº½ xin bá»™ nhá»› vÃ  giáº£i náº¡p modul vÃ o
* Khi sá»­ dá»¥ng xong má»™t modul, hoáº·c khi thiáº¿u vÃ¹ng nhá»› sáº½ Ä‘Æ°a nhá»¯ng modul  khÃ´ng cáº§n thiáº¿t ra ngoÃ i.

![[Pasted image 20221220091004.png]]

> [!check] Æ¯u Ä‘iá»ƒm
> * CÃ³ thá»ƒ sá»­ dá»¥ng vÃ¹ng nhá»› nhiá»u hÆ¡n pháº§n dÃ nh cho CT
> * Hiá»‡u quáº£ sá»­ dá»¥ng bá»™ nhá»› cao náº¿u quáº£n lÃ½ tá»‘t

> [!failure] NhÆ°á»£c Ä‘iá»ƒm
> * Tá»‘c Ä‘á»™ thá»±c hiá»‡n cháº­m
> * Sai láº§m sáº½ dáº«n tá»›i lÃ£ng phÃ­ bá»™ nhá»› vÃ  tÄƒng thá»i gian thá»±c hiá»‡n
> * YÃªu cáº§u ngÆ°á»i sá»­ dá»¥ng pháº£i náº¡p vÃ  xoÃ¡ cÃ¡c modul
> 	* NgÆ°á»i dÃ¹ng pháº£i náº¯m rÃµ há»‡ thá»‘ng
> 	* Giáº£m tÃ­nh lÆ°u Ä‘á»™ng

#### Cáº¥u trÃºc  liÃªn káº¿t Ä‘á»™ng
* CÃ¡c liÃªn káº¿t sáº½ hoÃ£n láº¡i tá»›i khi thá»±c hiá»‡n chÆ°Æ¡ng trÃ¬nh
* Má»™t pháº§n cá»§a Ä‘oáº¡n mÃ£ (stub) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¬m kiáº¿m thá»§ tá»¥c tÆ°Æ¡ng á»©ng trong thÆ° viá»‡n trong bá»™ nhá»›.
* Khi tÃ¬m tháº¥y, stub sáº½ Ä‘Æ°á»£c thay tháº¿ bá»Ÿi Ä‘á»‹a chá»‰ cá»§a thá»§ tá»¥c vÃ  thá»±c hiá»‡n thá»§ tá»¥c.

> [!check] Há»¯u Ã­ch cho xÃ¢y dá»±ng thÆ° viá»‡n

### Cáº¥u trÃºc Overlays
* Modul Ä‘Æ°á»£c chia thÃ nh cÃ¡c má»©c
	* **Má»©c 0** - chá»©a modul gá»‘c, náº¡p vÃ  Ä‘á»‹nh vá»‹ chÆ°Æ¡ng trÃ¬nh
	* **Má»©c 1** - chá»©a cÃ¡c modul Ä‘Æ°á»£c gá»i tá»« nhá»¯ng modul á»Ÿ má»©c 0 vÃ  ko Ä‘á»“ng thá»i tá»“n táº¡i ...

* Bá»™ nhá»› cÅ©ng Ä‘Æ°á»£c chia thÃ nh cÃ¡c má»©c **á»©ng vá»›i má»©c chÆ°Æ¡ng trÃ¬nh**
	* KÃ­ch thÆ°á»›c báº±ng kÃ­ch thÆ°á»›c cá»§a modul lá»›n nháº¥t cÃ¹ng má»©c

* Cáº§n cung cáº¥p thÃªm cÃ¡c thÃ´ng tin:
	* ChÆ°Æ¡ng trÃ¬nh bao nhiÃªu má»©c?
	* Má»—i má»©c gá»“m nhá»¯ng modul nÃ o ?
* ThÃ´ng tin cung cáº¥p Ä‘Æ°á»£c lÆ°u trong file (sÆ¡ Ä‘á»“ Overlays)

![[Há»‡ Äiá»u HÃ nh-Chuong 3-38-45.pdf]]

* Module má»©c 0 Ä‘Æ°á»£c biÃªn táº­p thÃ nh **file thá»±c thi riÃªng**

* Khi thá»±c hiá»‡n chÆ°Æ¡ng trÃ¬nh
	* Náº¡p module má»©c 0 nhÆ° chÆ°Æ¡ng trÃ¬nh tuyáº¿n tÃ­nh
	* CÃ¡c module khÃ¡c khi cáº§n tá»›i sáº½ Ä‘Æ°á»£c náº¡p vÃ o **má»©c bá»™ nhá»› tÆ°Æ¡ng á»©ng**
		* Náº¿u cÃ³ module Ä‘á»“ng má»©c tá»“n táº¡i : Ä‘Æ°a ra bÃªn ngoÃ i

**NHáº¬N XÃ‰T**: 
* Cho phÃ©p cháº¡y chÆ°Æ¡ng trÃ¬nh cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n kÃ­ch thÆ°á»›c HÄH dÃ nh cho.
* YÃªu cáº§u ngÆ°á»i sá»­ dá»¥ng cung cáº¥p cÃ¡c thÃ´ng tin phá»¥
	* Hiá»‡u quáº£ sá»­ dá»¥ng phá»¥ thuá»™c vÃ o cÃ¡c thÃ´ng tin Ä‘Æ°á»£c cung cáº¥p

* Hiá»‡u quáº£ sá»­ dá»¥ng bá»™ nhá»› phá»¥ thuá»™c vÃ o cÃ¡ch tá»• chá»©c cÃ¡c module  trong chÆ°Æ¡ng trÃ¬nh

> [!warning]
> Náº¿u tá»“n táº¡i má»™t module cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n cÃ¡c modul khÃ¡c cÃ¹ng má»©c ráº¥t nhiá»u 
> -> **Hiá»‡u quáº£ giáº£m rÃµ rá»‡t**

* QuÃ¡ trÃ¬nh náº¡p cÃ¡c module lÃ  Ä‘á»™ng, nhÆ°ng chÆ°Æ¡ng trÃ¬nh cÃ³ tÃ­nh cháº¥t tÄ©nh 
 **=> KhÃ´ng thay Ä‘á»•i trong cÃ¡c láº§n thá»±c hiá»‡n**

* Cung cáº¥p thÃªm bá»™ nhá»› tá»± do, hiá»‡u quáº£ váº«n khÃ´ng Ä‘á»•i.

## 2. CÃ¡c chiáº¿n lÆ°á»£c quáº£n lÃ½ bá»™ nhá»›
### 2.1 Chiáº¿n lÆ°á»£c phÃ¢n chÆ°Æ¡ng cá»‘ Ä‘á»‹nh
> [!abstract] NguyÃªn táº¯c
> * Bá»™ nhá»› Ä‘Æ°á»£c chia thÃ nh n pháº§n
> * Má»—i pháº§n gá»i lÃ  1 chÆ°Æ¡ng (partition)
> 	* KÃ­ch thÆ°á»›c: ko nháº¥t thiáº¿t pháº£i báº±ng nhau
> 	* ÄÆ°á»£c sá»­ dá»¥ng nhÆ° 1 vÃ¹ng nhá»› Ä‘á»™c láº­p
> 		* Táº¡i 1 thá»i Ä‘iá»ƒm chá»‰ cho phÃ©p 1 CT tá»“n táº¡i
> 		* CÃ¡c CT náº±m trong vÃ¹ng nhá»› cho tá»›i khi káº¿t thÃºc

![[Pasted image 20221220095742.png]]

> [!info] PhÃ¢n máº£nh trong
> PhÃ¢n máº£nh á»Ÿ bÃªn trong phÃ¢n vÃ¹ng, khÃ´ng gian dÆ° thá»«a trong má»—i phÃ¢n vÃ¹ng.

> [!check] Æ¯u Ä‘iá»ƒm
> * ÄÆ¡n giáº£n, dá»… tá»• chá»©c báº£o vá»‡
> 	* CT vÃ  vÃ¹ng nhá»› cÃ³ má»™t khoÃ¡ báº£o vá»‡
> 	* So sÃ¡nh 2 khoÃ¡ vá»›i nhau khi náº¡p CT
> * Giáº£m thá»i gian tÃ¬m kiáº¿m

> [!failure] NhÆ°á»£c Ä‘iá»ƒm
> * Pháº£i sao lÆ°u modul  Ä‘iá»u khiá»ƒn ra lÃ m nhiá»u báº£n vÃ  lÆ°u á»Ÿ nhiá»u nÆ¡i
> * Há»‡ sá»‘ song song khÃ´ng thá»ƒ vÆ°á»£t quÃ¡ n
> * Bá»‹ phÃ¢n Ä‘oáº¡n bá»™ nhá»›
> 	* KÃ­ch thÆ°á»›c CT lá»›n hÆ¡n kÃ­ch thÆ°á»›c chÆ°Æ¡ng lá»›n nháº¥t
> 	* Tá»•ng bá»™ nhá»› tá»± do cÃ²n lá»›n, nhÆ°ng khÃ´ng dÃ¹ng Ä‘á»ƒ náº¡p cÃ¡c CT khÃ¡c
> => Sá»­a láº¡i cáº¥u trÃºc chÆ°Æ¡ng, káº¿t há»£p má»™t sá»‘ chÆ°Æ¡ng ká» nhau

* ThÆ°á»ng dÃ¹ng Ä‘á»ƒ quáº£n lÃ½ cÃ¡c Ä‘Ä©a dung lÆ°á»£ng lá»›n.

### 2.2 Chiáº¿n lÆ°á»£c phÃ¢n chÆ°Æ¡ng Ä‘á»™ng
> [!abstract] NguyÃªn táº¯c
> Chá»‰ cÃ³ **1 danh sÃ¡ch** quáº£n lÃ½ bá»™ nhá»› tá»± do
> * Thá»i Ä‘iá»ƒm ban Ä‘áº§u, toÃ n bá»™ bá»™ nhá»› lÃ  **tá»± do** vá»›i cÃ¡c tiáº¿n trÃ¬nh => VÃ¹ng trá»‘ng lá»›n nháº¥t (hole)
> 
> * Khi tiáº¿n trÃ¬nh yÃªu cáº§u bá»™ nhá»›:
> 	* TÃ¬m trong DS vÃ¹ng trá»‘ng má»™t **pháº§n tá»­ Ä‘á»§ lá»›n** cho yÃªu cáº§u
> 	* Náº¿u tÃ¬m tháº¥y:
> 		* VÃ¹ng trá»‘ng Ä‘Æ°á»£c chia lÃ m hai pháº§n
> 		* 1 pháº§n cung cáº¥p cho TT
> 		* 1 pháº§n tráº£ láº¡i danh sÃ¡ch vÃ¹ng trá»‘ng tá»± do
> 	* Náº¿u ko tÃ¬m tháº¥y:
> 		* Chá» tá»›i khi tÃ¬m Ä‘Æ°á»£c vÃ¹ng trá»‘ng thoáº£ mÃ£n
> 		* Cho phÃ©p tiáº¿n trÃ¬nh khÃ¡c trong hÃ ng Ä‘á»£i thá»±c hiá»‡n (náº¿u **Ä‘á»™ Æ°u tiÃªn** Ä‘áº£m báº£o)
> 
> * Khi tiáº¿n trÃ¬nh káº¿t thÃºc:
> 	* VÃ¹ng nhá»› Ä‘Æ°á»£c tráº£ vá» DS quáº£n lÃ½ ban Ä‘áº§u
> 	* Káº¿t há»£p vá»›i cÃ¡c vÃ¹ng trá»‘ng khÃ¡c liá»n ká» náº¿u cáº§n

![[Pasted image 20221220100613.png]]

> [!note] CÃ¡c chiáº¿n lÆ°á»£c chá»n vÃ¹ng trá»‘ng cho yÃªu cáº§u
> * ***First Fit*** - vÃ¹ng trá»‘ng Ä‘áº§u tiÃªn thoáº£ mÃ£n
> * ***Best Fit*** - vÃ¹ng trá»‘ng vá»«a váº·n nháº¥t
> * **Worst Fit** - vÃ¹ng trá»‘ng kÃ­ch thÆ°á»›c lá»›n nháº¥t

#### Buddy Allocation
> [!note] Cung cáº¥p nhá»›
> Chia Ä‘Ã´i liÃªn tiáº¿p vÃ¹ng trá»‘ng tá»± do cho tá»›i khi thu Ä‘Æ°á»£c vÃ¹ng trá»‘ng nhá» nháº¥t thoáº£ mÃ£n

> [!example] VÃ­ dá»¥
> Cung cáº¥p cho yÃªu cáº§u n bytes
> * Chia vÃ¹ng trá»‘ng tÃ¬m Ä‘Æ°á»£c thÃ nh 2 khá»‘i báº±ng nhau (buddies)
> * Tiáº¿p tá»¥c chia vÃ¹ng trá»‘ng trÃªn thÃ nh 2 pháº§n cho tá»›i khi Ä‘áº¡t vÃ¹ng trá»‘ng nhá» nháº¥t cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n n. 
> * Äá»‘i vá»›i yÃªu cáº§u 800 bytes thÃ¬ cáº§n vÃ¹ng trá»‘ng 1k Bytes
> ![[Pasted image 20221220160240.png]]

* Há»‡ thá»‘ng duy trÃ¬ cÃ¡c danh sÃ¡ch vÃ¹ng trá»‘ng kÃ­ch thÆ°á»›c 1,2,..., 2^n bytes
* Vá»›i yÃªu cáº§u K -> tÃ¬m pháº§n tá»­ nhá» nháº¥t cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n K
* Náº¿u pháº§n tá»­ nhá» nháº¥t cÃ³ kÃ­ch thÆ°á»›c > 2K -> tiáº¿n hÃ nh chia liÃªn tiáº¿p cho tá»›i khi Ä‘Æ°á»£c vÃ¹ng nhá» nháº¥t cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n  K

> [!check] CÃ³ tá»‘c Ä‘á»™ duyá»‡t nhanh ( vá»›i bá»™ kÃ­ch thÆ°á»›c n, chá»‰ cáº§n duyá»‡t $\log _2 n$ danh sÃ¡ch)

> [!note] Thu há»“i vÃ¹ng nhá»›
> * Káº¿t há»£p 2 vÃ¹ng ká» nhau cÃ³ cÃ¹ng kÃ­ch thÆ°á»›c
> * Tiáº¿p tá»¥c káº¿t há»£p liÃªn tiáº¿p cho tá»›i khi táº¡o ra **vÃ¹ng trá»‘ng lá»›n nháº¥t** cÃ³ thá»ƒ

> [!example] VÃ­ dá»¥
> ![[Pasted image 20221220161727.png]]
> * Giáº£i phÃ³ng vÃ¹ng nhá»› thá»© nháº¥t (1K)
> 	* 2 * 1K = 2K
> * Giáº£i phÃ³ng vÃ¹ng nhá»› thá»© hai (2K)
> 	* 2 * 2K = 4K
> * Giáº£i phÃ³ng vÃ¹ng nhá»› thá»© ba (2K)
> 	* Káº¿t há»£p 2 vÃ¹ng 2K thÃ nh vÃ¹ng 4K
> 	* Káº¿t há»£p 2 vÃ¹ng 4K thÃ nh vÃ¹ng 8K
> 	* Káº¿t há»£p 2 vÃ¹ng 8K thÃ nh vÃ¹ng 16K


* Äá»‹a chá»‰ cá»§a hai khá»‘i nhá»› chá»‰ khÃ¡c nhau á»Ÿ bit thá»© **k**
![[Pasted image 20221220162129.png]]

#### Váº¥n Ä‘á» bá»‘ trÃ­ láº¡i bá»™ nhá»›
* Sau má»™t thá»i gian hoáº¡t Ä‘á»™ng, cÃ¡c vÃ¹ng trá»‘ng náº±m ráº£i rÃ¡c kháº¯p nÆ¡i gÃ¢y ra hiá»‡n tÆ°á»£ng thiáº¿u bá»™ nhá»›.
> [!warning] Cáº§n bá»‘ trÃ­ láº¡i bá»™ nhá»›

> [!note] Dá»‹ch chuyá»ƒn cÃ¡c tiáº¿n trÃ¬nh
> * Váº¥n Ä‘á» khÃ´ng Ä‘Æ¡n giáº£n vÃ¬ cÃ¡c Ä‘á»‘i tÆ°á»£ng bÃªn trong khi chuyá»ƒn sang vá»‹ trÃ­ má»›i sáº½ cÃ³ Ä‘á»‹a chá»‰ khÃ¡c.
> 	* Sá»­ dá»¥ng thanh ghi dá»‹ch chuyá»ƒn (relocatiopn register) chá»©a giÃ¡ trá»‹ báº±ng Ä‘á»™ dá»‹ch chuyá»ƒn cá»§a tiáº¿n trÃ¬nh
> * Váº¥n Ä‘á» lá»±a chá»n phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ chi phÃ­ nhá» nháº¥t
> 	* Táº¥t cáº£ vá» má»™t phÃ­a -> **VÃ¹ng trá»‘ng lá»›n nháº¥t**
> 	* Dá»‹ch chuyá»ƒn Ä‘á»ƒ táº¡o ra ngay láº­p tá»©c má»™t vÃ¹ng trá»‘ng vá»«a váº·n

> [!note] PhÆ°Æ¡ng phÃ¡p trÃ¡o Ä‘á»•i (swapping)
> * Lá»±a chá»n thá»i Ä‘iá»ƒm dá»«ng tiáº¿n trÃ¬nh Ä‘ang thá»±c hiá»‡n
> * ÄÆ°a tiáº¿n trÃ¬nh vÃ  tráº¡ng thÃ¡i tÆ°Æ¡ng á»©ng ra bÃªn ngoÃ i
> 	* Giáº£i phÃ³ng vÃ¹ng nhá»› Ä‘á»ƒ káº¿t há»£p vá»›i cÃ¡c pháº§n tá»­ liá»n ká»
> * TÃ¡i Ä‘á»‹nh vá»‹ vÃ o vá»‹ trÃ­ cÅ© vÃ  khÃ´i phá»¥c tráº¡ng thÃ¡i cÅ©
> 	* DÃ¹ng thanh ghi dá»‹ch chuyá»ƒn náº¿u Ä‘Æ°a vÃ o vá»‹ trÃ­ khÃ¡c

> [!check] Æ¯u Ä‘iá»ƒm
> * KhÃ´ng pháº£i sao lÆ°u modul Ä‘iá»u khiá»ƒn ra nhiá»u nÆ¡i
> * TÄƒng/giáº£m há»‡ sá»‘ song tuá»³ theo sá»‘ lÆ°á»£ng vÃ  kÃ­ch thÆ°á»›c chÆ°Æ¡ng trÃ¬nh

> [!failure] NhÆ°á»£c Ä‘iá»ƒm
> * KhÃ´ng thá»±c hiá»‡n Ä‘Æ°á»£c chÆ°Æ¡ng trÃ¬nh cÃ³ kÃ­ch thÆ°á»›c **lá»›n hÆ¡n** kÃ­ch thÆ°á»›c bá»™ nhá»› váº­t lÃ½
> * GÃ¢y ra hiá»‡n tÆ°á»£ng **rÃ¡c** 
> >Bá»™ nhá»› ko Ä‘Æ°á»£c sá»­ dá»¥ng, cÅ©ng ko náº±m trong DS quáº£n lÃ½ bá»™ nhá»› tá»± do, do lá»—i HÄH hoáº·c do pháº§n má»m phÃ¡ hoáº¡i
> * GÃ¢y ra hiá»‡n tÆ°á»£ng **phÃ¢n Ä‘oáº¡n ngoÃ i** 
> > VÃ¹ng nhá»› tá»± do Ä‘Æ°á»£c quáº£n lÃ½ Ä‘áº§y Ä‘á»§, nhÆ°ng náº±m ráº£i rÃ¡c nÃªn khÃ´ng sá»­ dá»¥ng Ä‘Æ°á»£c
> * GÃ¢y ra hiá»‡n tÆ°á»£ng **phÃ¢n Ä‘oáº¡n trong**
> > VÃ¹ng nhá»› dÃ nh cho chÆ°Æ¡ng trÃ¬nh nhÆ°ng khÃ´ng Ä‘Æ°á»£c chÆ°Æ¡ng trÃ¬nh sá»­ dá»¥ng tá»›i.

### 2.3 Chiáº¿n lÆ°á»£c phÃ¢n Ä‘oáº¡n
#### ChÆ°Æ¡ng trÃ¬nh
> [!note] ChÆ°Æ¡ng trÃ¬nh thÆ°á»ng gá»“m cÃ¡c modul
> * 1 CT chÃ­nh (main prog)
> * Táº­p cÃ¡c chÆ°Æ¡ng trÃ¬nh con
> * CÃ¡c biáº¿n, cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u ...

* CÃ¡c modul, Ä‘á»‘i tÆ°á»£ng trong c/trÃ¬nh Ä‘Æ°á»£c **xÃ¡c Ä‘á»‹nh báº±ng tÃªn**
	* HÃ m `sqrt()`, thá»§ tá»¥c `printf()`
	* x, y, counter, Buffer ...

* CÃ¡c pháº§n tá»­ trong modul Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh theo Ä‘á»™ lá»‡ch vá»›i vá»‹ trÃ­ ban Ä‘áº§u
	* CÃ¢u lá»‡nh thá»© 10 cá»§a hÃ m `sqrt()` ...
	* Pháº§n tá»­ thá»© 2 cá»§a máº£ng Buffer ....

> [!note] KhÃ´ng quan tÃ¢m tá»›i viá»‡c chÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c tá»• chá»©c ntn trong bá»™ nhá»›.

#### Quan Ä‘iá»ƒm ngÆ°á»i dÃ¹ng
* Khi Ä‘Æ°a ctrinh vÃ o bá»™ nhá»› Ä‘á»ƒ thá»±c hiá»‡n, ctrÃ¬nh cÃ³ **nhiá»u Ä‘oáº¡n khÃ¡c nhau**
* Má»—i Ä‘oáº¡n lÃ  1 **khá»‘i logic**, á»©ng vá»›i má»™t module
	* MÃ£ lá»‡nh: `main()`, thá»§ tá»¥c, hÃ m ...
	* Dá»¯ liá»‡u: Ä‘á»‘i tÆ°á»£ng toÃ n cá»¥c, cá»¥c bá»™
	* CÃ¡c Ä‘oáº¡n khÃ¡c: stack, máº£ng

* Má»—i Ä‘oáº¡n chiáº¿m **má»™t vÃ¹ng liÃªn tá»¥c**
	* CÃ³ vá»‹ trÃ­ báº¯t Ä‘áº§u vÃ  kÃ­ch thÆ°á»›c
	* CÃ³ thá»ƒ náº±m táº¡i báº¥t cá»© Ä‘Ã¢u trong bá»™ nhá»›

* Má»—i Ä‘á»‘i tÆ°á»£ng trong Ä‘oáº¡n Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi **vá»‹ trÃ­ tÆ°Æ¡ng Ä‘á»‘i** so vá»›i Ä‘áº§u Ä‘oáº¡n
![[Há»‡ Äiá»u HÃ nh-Chuong 3-77-79.pdf]]

#### Cáº¥u trÃºc phÃ¢n Ä‘oáº¡n
> [!note] Cáº¥u trÃºc phÃ¢n Ä‘oáº¡n
> * ChÆ°Æ¡ng trÃ¬nh lÃ  táº­p há»£p cÃ¡c Ä‘oáº¡n (modul, segment)
> 	* TÃªn Ä‘oáº¡n (**sá»‘ hiá»‡u Ä‘oáº¡n**), **Ä‘á»™ dÃ i** cá»§a Ä‘oáº¡n
> 	* Má»—i Ä‘oáº¡n cÃ³ thá»ƒ Ä‘Æ°á»£c **biÃªn táº­p riÃªng**
> * Khi dá»‹ch vÃ  biÃªn táº­p chÆ°Æ¡ng trÃ¬nh táº¡o ra ***Báº£ng quáº£n lÃ½ Ä‘oáº¡n (Segement Control Block - SCB)***
> 	* Má»—i pháº§n tá»­ cá»§a báº£ng á»©ng vá»›i má»™t Ä‘oáº¡n cá»§a chÆ°Æ¡ng trÃ¬nh
> 	![[Pasted image 20221220174709.png]]
> 	* ***Dáº¥u hiá»‡u (Mark)*** - mang giÃ¡ trá»‹ 0/1 dá»±a trÃªn sá»± tá»“n táº¡i cá»§a Ä‘oáº¡n trong bá»™ nhá»›
> 	* ***Äá»‹a chá»‰ (Address)*** - vá»‹ trÃ­ cÆ¡ sá»Ÿ cá»§a Ä‘oáº¡n trong bá»™ nhá»›
> 	* ***Äá»™ dÃ i (Length)*** - Ä‘á»™ dÃ i cá»§a Ä‘oáº¡n
> * ***Äá»‹a chá»‰ truy cáº­p*** = <`tÃªn(sá»‘ hiá»‡u Ä‘oáº¡n)`, `Ä‘á»™ lá»‡ch trong Ä‘oáº¡n`>

^f33fe2

> [!example] 
> ![[Há»‡ Äiá»u HÃ nh-Chuong 3-81-88.pdf]]

#### Chuyá»ƒn Ä‘á»•i Ä‘á»‹a chá»‰
Khi thá»±c hiá»‡n chÆ°Æ¡ng trÃ¬nh
* Báº£ng quáº£n lÃ½ Ä‘oáº¡n Ä‘Æ°á»£c náº¡p vÃ o bá»™ nhá»›
	* ***Segment-table base register (STBR)***: Vá»‹ trÃ­ SCB trong bá»™ nhá»›
	* ***Segment-table length register (STLR)***: sá»‘ pháº§n tá»­ cá»§a SCB

![[Pasted image 20221220201453.png]]

> [!note] Khi truy cáº­p tá»›i Ä‘á»‹a chá»‰ logic <s,d>
> 1. s $\geq$ STLR: lá»—i
> 2. STBR + s * K: vá»‹ trÃ­ pháº§n tá»­ s trong SCB
> 3. Kiá»ƒm tra trÆ°á»ng dáº¥u hiá»‡u M cá»§a pháº§n tá»­ SCBs
> 	* **M = 0**: Ä‘oáº¡n s chÆ°a tá»“n táº¡i trong bá»™ nhá»› => lá»—i truy nháº­p => HÄH pháº£i náº¡p Ä‘oáº¡n
> 		* Xin vÃ¹ng nhá»› cÃ³ kÃ­ch thÆ°á»›c Ä‘Æ°á»£c ghi trong L
> 		* TÃ¬m module tÆ°Æ¡ng á»©ng á»Ÿ bá»™ nhá»› ngoÃ i vÃ  náº¡p vÃ  Ä‘á»‹nh vá»‹ vÃ o vÃ¹ng nhá»› xin Ä‘Æ°á»£c
> 		* Sá»­a láº¡i trÆ°á»ng Ä‘á»‹a chá»‰ A vÃ  trÆ°á»ng dáº¥u hiá»‡u M (M=1)
> 		* Truy nháº­p bá»™ nhá»› nhÆ° trÆ°á»ng há»£p M = 1
> 	* **M = 1**: Ä‘oáº¡n Ä‘Ã£ tá»“n táº¡i trong bá»™ nhá»›
> 		* d $beq$ Ls: lá»—i  truy nháº­p (vÆ°á»£t quÃ¡ kÃ­ch thÆ°á»›c Ä‘oáº¡n)
> 		* d + As: Äá»‹a chá»‰ váº­t lÃ½ cáº§n tÃ¬m

> [!check] Æ¯u Ä‘iá»ƒm
> * SÆ¡ Ä‘á»“ náº¡p Module khÃ´ng cáº§n sá»± tham gia cá»§a ngÆ°á»i sá»­ dá»¥ng
> * Dá»… dÃ ng thá»±c hiá»‡n nhiá»‡m vá»¥ báº£o vá»‡ Ä‘oáº¡n
> 	* Kiá»ƒm tra lá»—i truy nháº­p bá»™ nhá»›
> 		* Äá»‹a chá»‰ khÃ´ng há»£p lá»‡: vÆ°á»£t quÃ¡ kÃ­ch thÆ°á»›c Ä‘oáº¡n
> 	* Kiá»ƒm tra tÃ­nh cháº¥t truy nháº­p
> 		* Äoáº¡n mÃ£: chá»‰ Ä‘á»c 
> 		-> *Viáº¿t vÃ o Ä‘oáº¡n mÃ£: lá»—i truy nháº­p*
> 	* Kiá»ƒm tra quyá»n truy nháº­p module
> 		* ThÃªm trÆ°á»ng quyá»n truy nháº­p (user/system) vÃ o SCB
> * Cho phÃ©p sá»­ dá»¥ng **chung Ä‘oáº¡n**
> 	* VD: soáº¡n tháº£o vÄƒn báº£n
> 	![[Pasted image 20221220203946.png]]

> [!warning] Váº¥n Ä‘á» chÃ­nh cá»§a viá»‡c dÃ¹ng chung Ä‘oáº¡n
> * Äoáº¡n dÃ¹ng chung pháº£i cÃ¹ng
> 	* Sá»‘ hiá»‡u trong SCB
> * Giáº£i quyáº¿t báº±ng cÃ¡ch truy nháº­p giÃ¡n tiáº¿p
> 	* JMP +08
> 	* Thanh ghi Ä‘oáº¡n chá»©a sá»‘ hiá»‡u Ä‘oáº¡n

> [!failure] NhÆ°á»£c Ä‘iá»ƒm
> * Hiá»‡u quáº£ sá»­ dá»¥ng phá»¥ thuá»™c vÃ o cáº¥u trÃºc chÆ°Æ¡ng trÃ¬nh
> * Bá»‹ phÃ¢n máº£nh bá»™ nhá»›
> 	* PhÃ¢n phá»‘i vÃ¹ng nhá»› theo cÃ¡c chiáº¿n lÆ°á»£c First fit/ best fit 
> 	* Cáº§n pháº£i bá»‘ trÃ­ láº¡i bá»‘ nhá»› (dá»‹ch chuyá»ƒn, swapping)
> 		* CÃ³ thá»ƒ dá»±a vÃ o báº£ng SCB
> 			* M = 0: Ä‘oáº¡n chÆ°a nháº­p vÃ o
> 			* VÃ¹ng nhá»› Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi A vÃ  L Ä‘Æ°á»£c tráº£ vá» Danh sÃ¡ch tá»± do
> 		* Váº¥n Ä‘á» lá»±a chá»n module cáº§n Ä‘Æ°a ra 
> 			* Module tá»“n táº¡i lÃ¢u nháº¥t
> 			* Module cÃ³ láº§n sá»­ dá»¥ng cuá»‘i cÃ¡ch xa nháº¥t
> 			* Module cÃ³ táº§n xuáº¥t sá»­ dá»¥ng tháº¥p nháº¥t
> 		=> Cáº§n phÆ°Æ¡ng tiá»‡n ghi láº¡i sá»‘ láº§n vÃ  thá»i Ä‘iá»ƒm truy nháº­p Ä‘oáº¡n

> [!tip] Giáº£i phÃ¡p:
> PhÃ¢n phá»‘i bá»™ nhá»› theo cÃ¡c Ä‘oáº¡n báº±ng nhau (page)

### 2.4 Chiáº¿n lÆ°á»£c phÃ¢n trang
> [!abstract] NguyÃªn táº¯c
> * Chia bá»™ nhá»› váº­t lÃ½ Ä‘Æ°á»£c chia thÃ nh tá»«ng khá»‘i cÃ³ kÃ­ch thÆ°á»›c báº±ng nhau, gá»i lÃ  ***frame***.
> 	* Trang váº­t lÃ½ Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ 0,1,2 -> Ä‘á»‹a chá»‰ váº­t lÃ½ cá»§a trang
> 	* Trang Ä‘Æ°á»£c dÃ¹ng lÃ m **Ä‘Æ¡n vá»‹ phÃ¢n phá»‘i nhá»›**
> * Bá»™ nhá»› logic (chÆ°Æ¡ng trÃ¬nh) Ä‘Æ°á»£c chia thÃ nh tá»«ng khá»‘i cÃ³ kÃ­ch thÆ°á»›c báº±ng trang váº­t lÃ½, gá»i lÃ  ***page***.

> [!info] Lá»—i trang - Page fault
> **Náº¿u trang nhá»› Ä‘Ã³ chÆ°a náº±m trong bá»™ nhá»› chÃ­nh**, hiá»‡n tÆ°á»£ng nÃ y chÃºng ta gá»i lÃ  lá»—i trang (Page fault), khá»‘i MMU sáº½ bÃ¡o cho há»‡ Ä‘iá»u hÃ nh Ä‘á»ƒ há»‡ Ä‘iá»u hÃ nh tiáº¿n hÃ nh náº¡p trang tÆ°Æ¡ng á»©ng tá»« bá»™ nhá»› ngoÃ i (vÃ­ dá»¥: á»• cá»©ng) vÃ  tiáº¿n hÃ nh thá»±c thi láº¡i lá»‡nh trÆ°á»›c Ä‘Ã³.

* Khi thá»±c hiá»‡n chÆ°Æ¡ng trÃ¬nh:
	* Náº¡p trang logic tá»« bá»™ nhá»› ngoÃ i vÃ o trang váº­t lÃ½
	* XÃ¢y dá»±ng má»™t ***báº£ng quáº£n lÃ½ trang*** (Page Control Block - PCB) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh má»‘i quan há»‡ giá»¯a trang váº­t lÃ½ vÃ  trang logic.
	* Má»—i pháº§n tá»­ cá»§a PCB á»©ng vá»›i má»™t trang CT
		* Cho biáº¿t trang váº­t lÃ½ chá»©a trang logic tÆ°Æ¡ng á»©ng.
	* Äá»‹a chá»‰ truy nháº­p Ä‘Æ°á»£c chia thÃ nh:
		* **Sá»‘ hiá»‡u trang - p**: chá»‰ sá»‘ trong PCB Ä‘á»ƒ tÃ¬m Ä‘á»‹a chá»‰ cÆ¡ sá»Ÿ trang
		* **Äá»™ lá»‡ch trong trang - d**: káº¿t há»£p Ä‘á»‹a chá»‰ cÆ¡ sá»Ÿ cá»§a trang Ä‘á»ƒ tÃ¬m ra Ä‘á»‹a chá»‰ váº­t lÃ½.

*ğŸ‘‰ LiÃªn há»‡ tá»›i báº£ng phÃ¢n Ä‘oáº¡n [[Chap3 - Quáº£n lÃ½ bá»™ nhá»›#^f33fe2]]*
![[Há»‡ Äiá»u HÃ nh-Chuong 3_Reduced-105-108.pdf]]

> [!note] 
> * **Dung lÆ°á»£ng** trang luÃ´n lÃ  **luá»¹ thá»«a 2** ( cho phÃ©p ghÃ©p giá»¯a sá»‘ hiá»‡u trang váº­t lÃ½ vÃ  Ä‘á»™ lá»‡ch trang)
> 	* VD: bá»™ nhá»› n bit, kÃ­ch thÆ°á»›c trang 2^k 
> 	![[Pasted image 20230115211834.png]]
> * **KhÃ´ng cáº§n náº¡p toÃ n bá»™** trang logic vÃ o
> 	* Sá»‘ frame phá»¥ thuá»™c vÃ o kÃ­ch thÆ°á»›c bá»™ nhá»›, trong khi Ä‘Ã³ sá»‘ page tuá»³ Ã½
> 	* PCB cáº§n **Mark** Ä‘á»ƒ nháº­n biáº¿t trang Ä‘Ã£ Ä‘Æ°á»£c náº¡p vÃ o bá»™ nhá»› hay chÆ°a
> 		* 0 - trang chÆ°a Ä‘Æ°á»£c lÆ°u vÃ o bá»™ nhá»› váº­t lÃ½
> 		* 1 - trang Ä‘Ã£ Ä‘Æ°á»£c Ä‘Æ°a vÃ o 

|PhÃ¢n trang|PhÃ¢n Ä‘oáº¡n|
|---|---|
|CÃ¡c modul phá»¥ thuá»™c cáº¥u trÃºc logic cá»§a CT|CÃ¡c khá»‘i cÃ³ kÃ­ch thÆ°á»›c Ä‘á»™c láº­p kÃ­ch thÆ°á»›c CT </br> nhÆ°ng phá»¥ thuá»™c vÃ o pháº§n cá»©ng|

![[Pasted image 20230115213457.png]]

#### Náº¡p CT vÃ o bá»™ nhá»›
![[Pasted image 20230115213704.png]]

> [!note]
> * Náº¿u Ä‘á»§ trang váº­t lÃ½ tá»± do -> **Náº¡p toÃ n bá»™**
> * Náº¿u khÃ´ng Ä‘á»§ trang váº­t lÃ½ tá»± do -> **Náº¡p tá»«ng pháº§n**

#### Truy nháº­p bá»™ nhá»›

![[Pasted image 20230115213846.png]]
* Náº¡p CT:
	* XÃ¢y dá»±ng báº£ng quáº£n lÃ½ trang vÃ  luÃ´n giá»¯ trong bá»™ nhá»›
		* **Page-table base register - PTBR** trá» tá»›i PCB
		* **Page-table length register - PTLR** kÃ­ch thÆ°á»›c PCB
* Thá»±c hiá»‡n truy nháº­p
	* Äá»‹a chá»‰ truy nháº­p Ä‘Æ°á»£c chia thÃ nh dáº¡ng <p,d>
	* $PTBR + p * K$ = Ä‘á»‹a chá»‰ pháº§n tá»­ p cá»§a PCB trong bá»™ nhá»› (K lÃ  kÃ­ch thÆ°á»›c 1 pháº§n tá»­ cá»§a PCB)
* Kiá»ƒm tra Mp (Mark of p):
	* Mp = 0 -> Lá»—i trang, sinh ra ngáº¯t Ä‘á»ƒ tiáº¿n hÃ nh náº¡p trang
		* Xin trang váº­t lÃ½ tá»± do
		* TÃ¬m kiáº¿m trang logic á»Ÿ bá»™ nhá»› ngoÃ i vÃ  náº¡p trang
		* Sá»­a láº¡i trÆ°á»ng Ä‘á»‹a chá»‰ A (address) vÃ  dáº¥u hiá»‡u M
	* Mp = 1 -> trang Ä‘Ã£ tá»“n táº¡i
		* Láº¥y Ap  ghÃ©p vá»›i d ra Ä‘á»‹a chá»‰ cáº§n tÃ¬m

#### Náº¡p trang vÃ  thay tháº¿ trang
> [!warning] 
> * TH sá»‘ trang váº­t lÃ½ dÃ nh cho CT lá»›n
> 	* Thá»±c hiá»‡n nhanh, nhÆ°ng há»‡ sá»‘ song song giáº£m
> * TH sá»‘ trang váº­t lÃ½ dÃ nh cho CT bÃ©
> 	* Há»‡ sá»‘ song song cao nhÆ°ng thá»±c hiá»‡n cháº­m do hay thiáº¿u trang
> 
> **=> Hiá»‡u quáº£ phá»¥ thuá»™c nhiá»u vÃ o cÃ¡c chiáº¿n lÆ°á»£c náº¡p trang vÃ  thay tháº¿ trang**

* CÃ¡c chiáº¿n lÆ°á»£c náº¡p trang:
	* **Náº¡p táº¥t cáº£** - náº¡p toÃ n bá»™ CT
	* **Náº¡p trÆ°á»›c** - dá»± bÃ¡o trang cáº§n thiáº¿t tiáº¿p theo
	* **Náº¡p theo yÃªu cáº§u** - chá»‰ náº¡p khi cáº§n thiáº¿t

* CÃ¡c chiáº¿n lÆ°á»£c thay tháº¿ trang:
	* FIFO
	* LRU - Least Recently Used
	* LFU - Least Frequently Used

> [!check] Æ¯u Ä‘iá»ƒm cá»§a chiáº¿n lÆ°á»£c phÃ¢n trang
> * TÄƒng tá»‘c Ä‘á»™ truy nháº­p 
> * KhÃ´ng tá»“n táº¡i hiá»‡n tÆ°á»£ng phÃ¢n Ä‘oáº¡n ngoÃ i
> * Há»‡ sá»‘ song song cao
> * Dá»… dÃ ng thá»±c hiá»‡n nhiá»‡m vá»¥ báº£o vá»‡
> * Cho phÃ©p sá»­ dá»¥ng chung trang

> [!note] DÃ¹ng chung trang - Soáº¡n tháº£o vÄƒn báº£n 
> ![[Pasted image 20230115232705.png]]
> * Cáº§n thiáº¿t trong mÃ´i trÆ°á»ng hoáº¡t Ä‘á»™ng cÃ³ sá»± chia sáº» -> giáº£m kÃ­ch thÆ°á»›c vÃ¹ng nhá»› cho táº¥t cáº£ cÃ¡c tiáº¿n trÃ¬nh
> * Pháº§n mÃ£ dÃ¹ng chung:
> 	* Chá»‰ cÃ³ 1 phiÃªn báº£n chia sáº» giá»¯a cÃ¡c TT trong bá»™ nhá»›
> 	* Váº¥n Ä‘á» náº£y sinh: mÃ£ dÃ¹ng chung ko Ä‘á»•i -> Trang dÃ¹ng chung pháº£i cÃ¹ng vá»‹ trÃ­ trong khÃ´ng gian logic cá»§a táº¥t cáº£ cÃ¡c TT -> CÃ¹ng sá»‘ hiá»‡u trong báº£ng quáº£n lÃ½ trang
> * Pháº§n mÃ£ vÃ  dá»¯ liá»‡u riÃªng biá»‡t cho cÃ¡c TT cÃ³ thá»ƒ náº±m á»Ÿ báº¥t cá»© Ä‘áº§u trong bá»™ nhá»› logic cá»§a TT

> [!failure] NhÆ°á»£c Ä‘iá»ƒm cá»§a chiáº¿n lÆ°á»£c phÃ¢n trang
> * Tá»“n táº¡i hiá»‡n tÆ°á»£ng phÃ¢n Ä‘oáº¡n trong
> 	* LuÃ´n xuáº¥t hiá»‡n á»Ÿ trang cuá»‘i 
> 	* CÃ³ thá»ƒ giáº£m kÃ­ch thÆ°á»›c trang Ä‘á»ƒ giáº£m hiá»‡n tÆ°á»£ng phÃ¢n Ä‘oáº¡n ?
> 		* Ko vÃ¬ sáº½ tÄƒng kháº£ nÄƒng gáº·p lá»—i trang
> 		* VÃ  lÃ m tÄƒng kÃ­ch thÆ°á»›c cá»§a báº£ng quáº£n lÃ½ trang
> * ÄÃ²i há»i há»— trá»£ cá»§a pháº§n cá»©ng (chi phÃ­ lá»›n)
> * Khi CT lá»›n, PCB cÃ³ nhiá»u pháº§n tá»­ -> tá»‘n bá»™ nhá»› lÆ°u trá»¯ PCB
> 
> âœ…Solution : DÃ¹ng ***Trang nhiá»u má»©c***

> [!info] Trang nhiá»u má»©c
> Báº£ng quáº£n lÃ½ Ä‘Æ°á»£c phÃ¢n trang
> ![[Há»‡ Äiá»u HÃ nh-Chuong 3_Reduced-122-126.pdf]]

### 2.5 Chiáº¿n lÆ°á»£c káº¿t há»£p phÃ¢n Ä‘oáº¡n - phÃ¢n tráº¡ng
> [!abstract] NguyÃªn táº¯c
> * CT Ä‘Æ°á»£c biÃªn táº­p theo cháº¿ Ä‘á»™ **phÃ¢n Ä‘oáº¡n**
> 	* Táº¡o ra báº£ng quáº£n lÃ½ Ä‘oáº¡n SCB
> 	* MÃµi pháº§n tá»­ cá»§a báº£ng quáº£n lÃ½ Ä‘oáº¡n á»©ng vá»›i 1 Ä‘oáº¡n (<M,A,L>)
> * Má»—i Ä‘oáº¡n Ä‘Æ°á»£c biÃªn táº­p riÃªng theo cháº¿ Ä‘á»™ **phÃ¢n trang**
> 	* Táº¡o ra báº£ng quáº£n lÃ½ trang cho tá»«ng Ä‘oáº¡n
> * Äá»‹a chá»‰ truy nháº­p: **<s,p,d>**
> * Thá»±c hiá»‡n truy nháº­p Ä‘á»‹a chá»‰:
> 	* $STBR + s = As$ - Ä‘á»‹a chá»‰ pháº§n tá»­ s
> 	* Kiá»ƒm tra Ms, náº¡p PCBs náº¿u cáº§n
> 	* $As + p = Ap$ - Äá»‹a chá»‰ pháº§n tá»­ p cá»§a PCBs
> 	* Kiá»ƒm tra Mp, náº¡p trang p náº¿u cáº§n
> 	* GhÃ©p Ap vá»›i d ra Ä‘Æ°á»£c Ä‘á»‹a chá»‰ cáº§n tÃ¬m 

![[Pasted image 20230115234403.png]]

![[Pasted image 20230115234521.png]]

## 3. Bá»™ nhá»› áº£o
### 3.1 Giá»›i thiá»‡u
> [!question] VÃ¬ sao cáº§n tá»›i bá»™ nhá»› áº£o?
> ![[Pasted image 20230115234942.png]]
> * CT trong 1 khÃ´ng gian Ä‘á»‹a chá»‰ áº£o cÃ³ thá»ƒ lá»›n tuá»³ Ã½
> * CÃ³ thá»ƒ cÃ³ nhiá»u CT cÃ¹ng tá»“n táº¡i -> TÄƒng hiá»‡u suáº¥t sá»­ dá»¥ng CPU
> * Giáº£m yÃªu cáº§u vÃ o/ra cho viá»‡c náº¡p vÃ  hoÃ¡n Ä‘á»•i CT -> kÃ­ch thÆ°á»›c swap nhá» hÆ¡n

![[Pasted image 20230115234956.png]]

> [!info]
> * DÃ¹ng bá»™ nhá»› thá»© cáº¥p (HardDisk) lÆ°u trá»¯ pháº§n CT chÆ°a Ä‘Æ°a vÃ o bá»™ nhá»› váº­t lÃ½
> * PhÃ¢n tÃ¡ch bá»™ nhá»› logic cá»§a ngÆ°á»i dÃ¹ng vá»›i bá»™ nhá»› váº­t lÃ½
> * VM Ã¡nh xáº¡ Ä‘á»‹a chá»‰ trong CT tá»›i Ä‘á»‹a chá»‰ váº­t lÃ½
> * Cho phÃ©p tháº» Ã¡nh xáº¡ vÃ¹ng nhá»› logic lá»›n vÃ o bá»™ nhá»› váº­t lÃ½ nhá»
> * CÃ i Ä‘áº·t theo:
> 	* PhÃ¢n trang
> 	* PhÃ¢n Ä‘oáº¡n
> 
> ![[Pasted image 20230115235331.png]]

* Náº¡p tá»«ng pháº§n cá»§a trang CT vÃ o bá»™ nhá»›
	* Trang cá»§a TT cÃ³ thá»ƒ náº±m trÃªn bá»™ nhá»› váº­t lÃ½ cÅ©ng nhÆ° náº±m trÃªn bá»™ nhá»› áº£o
	* Biá»ƒu diá»…n nhá» 1 bit trong báº£ng quáº£n lÃ½ trang (page table)
	* Khi yÃªu cáº§u trang, trang sáº½ Ä‘Æ°á»£c Ä‘Æ°a tá»« bá»™ nhá»› thá»© cáº¥p (bá»™ nhá»› áº£o) -> bá»™ nhá»› váº­t lÃ½ (RAM)
	[[Pasted image 20230115235639.png]]

* Xá»­ lÃ½ lá»—i trang:
	* Tiáº¿n hÃ nh Ä‘á»•i trang khi khÃ´ng cÃ³ frames tá»± do
	[[Pasted image 20230115235830.png]]

> [!note] Äá»•i trang
> 1. XÃ¡c Ä‘á»‹nh vá»‹ trÃ­ trang logic trÃªn Ä‘Ä©a
> 2. Lá»±a chá»n trang váº­t lÃ½
> 	* Ghi ra Ä‘Ä©a
> 	* Sá»­a láº¡i bit valid - invalid trong page table
> 3. Náº¡p trang logic vÃ o trang váº­t lÃ½ Ä‘Æ°á»£c chá»n
> 4. Restart TT
> ![[Pasted image 20230116000137.png]]

### 3.2 CÃ¡c chiáº¿n lÆ°á»£c Ä‘á»•i trang
> [!note] FIFO - First In First Out
> ![[Pasted image 20230116000300.png]]
> 
> > **ÄÆ°a ra trang theo thá»© tá»± vÃ o, trang vÃ o sá»›m nháº¥t ra Ä‘áº§u tiÃªn**
> 
> * Hiá»‡u quáº£ chá»‰ khi CT cÃ³ cáº¥u trÃºc tuyáº¿n tÃ­nh
> * KÃ©m hiá»‡u quáº£ khi CT theo nguyÃªn táº¯c láº­p trÃ¬nh cáº¥u trÃºc
> * ÄÆ¡n giáº£n, dá»… thá»±c hiá»‡n
> * TÄƒng trang váº­t lÃ½, khÃ´ng Ä‘áº£m báº£o giáº£m sá»‘ láº§n gáº·p lá»—i trang

> [!note] OPT/MIN - Thuáº­t toÃ¡n thay tháº¿ trang tá»‘i Æ°u
> ![[Pasted image 20230116000839.png]]
> > **ÄÆ°a ra trang cÃ³ láº§n sá»­ dá»¥ng tiáº¿p theo cÃ¡ch xa nháº¥t**
> 
> * Sá»‘ láº§n gáº·p lá»—i trang Ã­t nháº¥t
> * KhÃ³ dá»± bÃ¡o Ä‘Æ°á»£c diá»…n biá»…n cá»§a CT

> [!note] LRU - Least Recently Used
> ![[Pasted image 20230116001124.png]]
> 
> > ÄÆ°a ra trang cÃ³ láº§n sá»­ dá»¥ng cuá»‘i cÃ¡ch xa nháº¥t
> 
> * Hiá»‡u quáº£ cho chiáº¿n lÆ°á»£c thay trang
> * Äáº£m báº£o giáº£m sá»‘ lá»—i trang khi tÄƒng sá»‘ trang váº­t lÃ½
> 	* Táº­p cÃ¡c trang trong bá»™ nhá»› cÃ³ n frames luÃ´n lÃ  táº­p con cá»§a cÃ¡c trang trong bá»™ nhá»› cÃ³ n+1 frames
> * YÃªu cáº§u sá»± trá»£ giÃºp ká»¹ thuáº­t Ä‘á»ƒ chá»‰ ra thá»i Ä‘iá»ƒm truy cáº­p cuá»‘i

* CÃ i Ä‘áº·t LRU:
	* DÃ¹ng dÃ£y sá»‘ ghi trang
		* Truy cáº­p tá»›i 1 trang, cho pháº§n tá»­ tÆ°Æ¡ng á»©ng lÃªn Ä‘áº§u
		* Thay tháº¿ trang, cho phÃ¢n tá»­ xuá»‘ng cuá»‘i dÃ£y
		* ThÆ°á»ng cÃ i Ä‘áº·t dÆ°á»›i dáº¡ng Double Linked-List (tuy váº­y tá»‘n thá»i gian trong viá»‡c gÃ¡n con trá»)
	* Bá»™ Ä‘áº¿m
		* ThÃªm 1 trÆ°á»ng ghi thá»i Ä‘iá»ƒm truy nháº­p vÃ o má»—i pháº§n tá»­ cá»§a PCB
		* ThÃªm vÃ o khá»‘i Ä‘iá»u khiá»ƒn (C.U) Ä‘á»“ng há»“/bá»™ Ä‘áº¿m
		* Khi cÃ³ yÃªu cáº§u truy nháº­p trang
			* TÄƒng bá»™ Ä‘áº¿m
			* ChÃ©p ná»™i dung bá»™ Ä‘áº¿m vÃ o trÆ°á»ng thá»i Ä‘iá»ƒm truy nháº­p táº¡i pháº§n tá»­ tÆ°Æ¡ng á»©ng trong PCB
		* Cáº§n cÃ³ thá»§ tá»¥c cáº­p nháº­t PCB (ghi vÃ o trÆ°á»ng thá»i Ä‘iá»ƒm) vÃ  thá»§ tá»¥c tÃ¬m kiáº¿m trang cÃ³ giÃ¡ trá»‹ trÆ°á»ng thá»i Ä‘iá»ƒm nhá» nháº¥t
		* Hiá»‡n tÆ°á»£ng trÃ n sá»‘ !?

#### CÃ¡c thuáº­t toÃ¡n dá»±a trÃªn bá»™ Ä‘áº¿m
* Sá»­ dá»¥ng bá»™ Ä‘áº¿m (1 trÆ°á»ng cá»§a PCB) ghi nháº­n sá»‘ láº§n truy nháº­p tá»›i trang

> [!note] LFU - Least Frequently Used
> > Trang cÃ³ bá»™ Ä‘áº¿m nhá» nháº¥t bá»‹ thay tháº¿
> 
> * Trang Ä‘Æ°á»£c truy nháº­p nhiá»u Ä‘áº¿n -> lÃ  trang quan trá»ng -> há»£p lÃ½
> * Trang Ä‘Æ°á»£c dÃ¹ng nhiá»u, nhÆ°ng chá»‰ á»Ÿ giai Ä‘oáº¡n Ä‘áº§u (trang má»›i táº¡o) -> cáº§n dá»‹ch bá»™ Ä‘áº¿m 1 bit theo thá»i gian


> [!note] MFU - Most Frequently Used
> > Trang cÃ³ bá»™ Ä‘áº¿m lá»›n nháº¥t bá»‹ thay tháº¿
> 
> * Trang cÃ³ bá»™ Ä‘áº¿m nhá» nháº¥t cÃ³ thá»ƒ lÃ  trang vá»«a Ä‘Æ°á»£c náº¡p vÃ o vÃ  chÆ°a Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u
> -> cÃ³ thá»ƒ cáº§n sá»­ dá»¥ng trong tÆ°Æ¡ng lai

## 4. Quáº£n lÃ½ bá»™ nhá»› trong VXL há» intel


